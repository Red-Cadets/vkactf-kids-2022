## Macrosoft Word

| Событие | Название | Категория | Сложность |
| :------ | ---- | ---- | ---- |
| VKACTF kids 2022 | Macrosoft Word | Обратная разработка | Средняя |

  
### Описание


> Автор: [ Pro_Kuror ]
>
> После скандала с файлами, обнаруженными на компьютере информатика, учителя отправили преподавать историю. И тут он смог отличиться - ответы к тесту запаролены, а защита стала серьезнее!



### Решение

При скачивании стоит обратить внимание на раcширение файла - `.docm`

> Расширение `.docm` файла связано с Microsoft Word, содержит встроенные макросы, которые могут быть выполнены в документе

Открываем докумет, видим тест по истории компьютерной безопасности, форму для ввода пароля, обращаем внимание на один из вопросов - `Какой флаг?`


Пароль явно не угадать, посмотрим код макроса: 

>Вид -> макросы -> Изменить -> В окне project ПКМ нажимаем на UserForm1 -> View Code

Находим процедуру `CommandButton1_Click()`, где в первой строке имеется проверка введенного в форму пароля:

```vb
If TextBox1.Text = "7264f022a8180068013a00996d8ee91c" Then
```


Пробуем еще раз запустить макрос, либо заново открываем документ, вводим найденный пароль, получаем ответы на все вопросы.


### Флаг


```
vka{macr0S_Cr34te5_c0mPUtER_s3cUR1tY_h1S70ry}
```
