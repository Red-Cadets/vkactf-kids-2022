## Asm

| Событие | Название | Категория | Сложность |
| :------ | ---- | ---- | ---- |
| VKACTF kids 2022 | Asm | Обратная разработка | Легкая |


### Описание


> Автор: [ Rex ]
>
> Assembler... Знаете что это, но никогда не видели ассемблерный код? 
>
> Или вы в первый раз слышите это слово?
>
> Ничего страшного, это задание позволит вам познакомится с машинным языком.
>
> Вам необходимо решить несколько простых уравнений и записать ответ в формате:
>
> vka{answer1_answer2_answer3}
>
> P.S. В десятичном виде)



### Решение

##### Пример 0

```assembly
Какое значение оказалось в регистре EAX ?

mov bh, 6
mov ax, 305
xor ax, bx
sub ax, 40
```

Попробуем упростить понимание этого кода

```assembly
1) bh = 6
   bx = 0x600
2) ax = 305 = 0x131
3) bx ^ ax = 0x600 ^ 0x131 = 0x731 = 1841
   ax = 1841
4) ax = 1841 - 40 = 1801
```

Итак ответ на первый пример **1801**

##### Пример 1

```assembly
Какое значение оказалось в регистре EDX ?

mov edx, 1337
mov CL, 5
mul edx, ecx
add edx, 100
```

Упрощая этот код, получаем

```assembly
1) edx = 1337
2) CL = 5
   ecx = 5
3) edx = edx * ecx = 1337 * 5 = 6685
4) edx = edx + 100 = 6685 + 100 = 6785
```

Ответ на второй пример **6785**

##### Пример 2

```assembly
Какие Х больше 2 необходимо ввести, чтобы в конце EAX был равен 0?

mov eax, X
mov CL, 5
mov ebx, X
inc CL
mul eax, ebx
inc CL
mul ecx, ebx
add eax, 10
sub eax, ecx


```

Производим те же операции, но вместо конкретных значений оставим X 

```assembly
1) eax = X
2) CL = 5
3) ebx = X
4) CL = 5 + 1 = 6
5) eax = eax * ebx = X * X 
   eax = X * X
6) CL = 6 + 1 = 7
   ecx = CL
7) ecx = ecx * X = 7 * X
   ecx = 7 * X
8) eax = X * X + 10
9) eax - ecx = X * X + 10 - 7 * X, и это выражение должно быть равно 0
   X * X - 7 * X + 10 = 0   
```

Решаем квадратное уравнение и получаем корни 2 и 5. По условию X > 2. Тогда окончательным ответом будет значение **X=5**


### Флаг


```
vka{1801_6785_5}
```
